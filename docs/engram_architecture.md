# Engram Architecture

## System Architecture Diagram

```
┌───────────────────────────────────────────────────────────────────────────┐
│                               Engram System                                │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                           │
│  ┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐   │
│  │                 │      │                 │      │                 │   │
│  │    API Layer    │◄────►│  Memory Manager │◄────►│ Storage Backend │   │
│  │                 │      │                 │      │                 │   │
│  └────────┬────────┘      └────────┬────────┘      └────────┬────────┘   │
│           │                        │                        │            │
│           │                        │                        │            │
│           ▼                        ▼                        ▼            │
│  ┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐   │
│  │                 │      │                 │      │                 │   │
│  │ Compartment Mgr │◄────►│  Latent Space   │◄────►│  Vector DB      │   │
│  │                 │      │                 │      │  Integration    │   │
│  └─────────────────┘      └─────────────────┘      └─────────────────┘   │
│                                                                           │
│                                                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                         Integration Layer                            │  │
│  │                                                                      │  │
│  │  ┌─────────────────┐      ┌─────────────────┐     ┌──────────────┐  │  │
│  │  │                 │      │                 │     │              │  │  │
│  │  │ Hermes Adapter  │◄────►│  LLM Adapter    │◄───►│ Memory CLI   │  │  │
│  │  │                 │      │                 │     │              │  │  │
│  │  └─────────────────┘      └─────────────────┘     └──────────────┘  │  │
│  │                                                                      │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                           │
└───────────────────────────────────────────────────────────────────────────┘


┌───────────────────────────────────────────────────────────────────────────┐
│                             External Components                            │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                           │
│  ┌─────────────────┐      ┌─────────────────┐      ┌─────────────────┐   │
│  │                 │      │                 │      │                 │   │
│  │     Hermes      │◄────►│     Rhetor      │◄────►│     Other       │   │
│  │                 │      │                 │      │   Components    │   │
│  └─────────────────┘      └─────────────────┘      └─────────────────┘   │
│                                                                           │
└───────────────────────────────────────────────────────────────────────────┘
```

## Memory Data Flow

```
┌───────────────────────────────────────────────────────────────────────────┐
│                            Memory Operations                               │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                           │
│  ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐     │
│  │                 │     │                 │     │                 │     │
│  │    Memory Add   │────►│  Text Processing│────►│ Vector Embedding│     │
│  │                 │     │                 │     │                 │     │
│  └─────────────────┘     └─────────────────┘     └────────┬────────┘     │
│                                                           │              │
│                                                           │              │
│                                                           ▼              │
│  ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐     │
│  │                 │     │                 │     │                 │     │
│  │  Search Results │◄────┤  Vector Search  │◄────┤  Vector Storage │     │
│  │                 │     │                 │     │                 │     │
│  └─────────────────┘     └─────────────────┘     └─────────────────┘     │
│                                                                           │
└───────────────────────────────────────────────────────────────────────────┘
```

## Storage Layer

```
┌───────────────────────────────────────────────────────────────────────────┐
│                           Storage Architecture                             │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                     Memory Service Interface                         │  │
│  └─────────────────────────────────────────────────┬───────────────────┘  │
│                                                    │                      │
│                 ┌───────────────────┬──────────────┴──────────┐           │
│                 │                   │                         │           │
│                 ▼                   ▼                         ▼           │
│  ┌─────────────────────┐  ┌─────────────────────┐  ┌─────────────────────┐│
│  │                     │  │                     │  │                     ││
│  │   FAISS Storage     │  │   LanceDB Storage   │  │   File Storage      ││
│  │                     │  │                     │  │                     ││
│  └─────────────────────┘  └─────────────────────┘  └─────────────────────┘│
│                                                                           │
│  ┌───────────────────────────────────────────────────────────────────────┐│
│  │                           Fallback Mechanism                          ││
│  └───────────────────────────────────────────────────────────────────────┘│
│                                                                           │
└───────────────────────────────────────────────────────────────────────────┘
```

## Latent Space System

```
┌───────────────────────────────────────────────────────────────────────────┐
│                          Latent Space System                               │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                           │
│  ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐     │
│  │                 │     │                 │     │                 │     │
│  │  Thought Init   │────►│ Thought Refine  │────►│ Convergence     │     │
│  │                 │     │                 │     │ Detection       │     │
│  └─────────────────┘     └─────────────────┘     └────────┬────────┘     │
│                                                           │              │
│                                                           │              │
│                                                           ▼              │
│  ┌─────────────────┐     ┌─────────────────┐     ┌─────────────────┐     │
│  │                 │     │                 │     │                 │     │
│  │ Reasoning Trace │◄────┤ Thought Finalize│◄────┤ Iteration      │     │
│  │                 │     │                 │     │ Storage        │     │
│  └─────────────────┘     └─────────────────┘     └─────────────────┘     │
│                                                                           │
└───────────────────────────────────────────────────────────────────────────┘
```

## Memory Compartments

```
┌───────────────────────────────────────────────────────────────────────────┐
│                         Memory Compartments                                │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                           │
│  ┌─────────────────────────────────┐                                      │
│  │         Root Namespace          │                                      │
│  └─────────────┬───────────────────┘                                      │
│                │                                                          │
│                ▼                                                          │
│  ┌───────────────────────────────────────────────────────────────────┐   │
│  │                                                                   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐           │   │
│  │  │ Compartment │    │ Compartment │    │ Compartment │           │   │
│  │  │     A       │    │     B       │    │     C       │           │   │
│  │  └──────┬──────┘    └──────┬──────┘    └──────┬──────┘           │   │
│  │         │                  │                  │                   │   │
│  │         ▼                  ▼                  ▼                   │   │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐           │   │
│  │  │   Sub-      │    │   Sub-      │    │   Sub-      │           │   │
│  │  │ Compartment │    │ Compartment │    │ Compartment │           │   │
│  │  │    A.1      │    │    B.1      │    │    C.1      │           │   │
│  │  └─────────────┘    └─────────────┘    └─────────────┘           │   │
│  │                                                                   │   │
│  └───────────────────────────────────────────────────────────────────┘   │
│                                                                           │
└───────────────────────────────────────────────────────────────────────────┘
```

## API Endpoints

```
┌───────────────────────────────────────────────────────────────────────────┐
│                             API Endpoints                                  │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                               /memory                               │  │
│  │                                                                     │  │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐             │  │
│  │  │    POST     │    │     GET     │    │   DELETE    │             │  │
│  │  │   (Add)     │    │ (Retrieve)  │    │  (Remove)   │             │  │
│  │  └─────────────┘    └─────────────┘    └─────────────┘             │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                               /search                               │  │
│  │                                                                     │  │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐             │  │
│  │  │    POST     │    │   Semantic  │    │   Keyword   │             │  │
│  │  │   (Query)   │    │    Search   │    │    Search   │             │  │
│  │  └─────────────┘    └─────────────┘    └─────────────┘             │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                           │
│  ┌─────────────────────────────────────────────────────────────────────┐  │
│  │                            /compartments                            │  │
│  │                                                                     │  │
│  │  ┌─────────────┐    ┌─────────────┐    ┌─────────────┐             │  │
│  │  │    POST     │    │     GET     │    │ /activate   │             │  │
│  │  │  (Create)   │    │   (List)    │    │/deactivate  │             │  │
│  │  └─────────────┘    └─────────────┘    └─────────────┘             │  │
│  └─────────────────────────────────────────────────────────────────────┘  │
│                                                                           │
└───────────────────────────────────────────────────────────────────────────┘
```

## Component Integrations

```
┌───────────────────────────────────────────────────────────────────────────┐
│                        Engram Integration Model                            │
├───────────────────────────────────────────────────────────────────────────┤
│                                                                           │
│                        ┌─────────────────┐                                │
│                        │                 │                                │
│                        │     Hermes      │                                │
│                        │                 │                                │
│                        └────────┬────────┘                                │
│                                 │                                         │
│                                 │                                         │
│  ┌─────────────────┐    ┌──────▼────────┐    ┌─────────────────┐         │
│  │                 │    │                │    │                 │         │
│  │     Rhetor      │◄───┤     Engram     │───►│     Telos      │         │
│  │                 │    │                │    │                 │         │
│  └─────────────────┘    └──────┬────────┘    └─────────────────┘         │
│                                 │                                         │
│                                 │                                         │
│  ┌─────────────────┐    ┌──────▼────────┐    ┌─────────────────┐         │
│  │                 │    │                │    │                 │         │
│  │     Athena      │◄───┤  Tekton Core   │───►│    Codex       │         │
│  │                 │    │                │    │                 │         │
│  └─────────────────┘    └───────────────┘    └─────────────────┘         │
│                                                                           │
└───────────────────────────────────────────────────────────────────────────┘
```